# InkSight 硬件指南

## 1. BOM (物料清单)

| 组件 | 选型型号 | 关键参数 | 作用 | 参考价格 |
|------|---------|---------|------|---------|
| MCU | ESP32-C3 SuperMini | RISC-V, WiFi, 超低功耗 | 主控 | ~$3 |
| Display | 4.2" E-Paper Module | SPI 接口, 400x300, SSD1683 驱动 | 显示 | ~$15 |
| Power | 18650 LiFePO4 | 3.2V 标称电压, 1500mAh+ | 供电 (直驱) | ~$5 |
| Charger | TP5000 模块 | 支持 3.6V 截止电压 (需跳线) | 电池充电 | ~$2 |
| Case | PCB Sandwich / 3D 打印 | FR4 沉金工艺, M3 铜柱 | 结构支撑 | ~$5 |

**总 BOM 成本:** < $30

## 2. 引脚映射 (Pin Map)

### 电源域

```
USB VBUS (5V) ──> TP5000 IN
TP5000 OUT ──> Battery (3.2V)
Battery ──> ESP32 3.3V Pin (直连，旁路 LDO)
Battery ──> 100K Resistor ──> GPIO 0 (ADC) (电压检测)
```

### SPI 信号域 (ESP32-C3 -> E-Ink)

| ESP32 Pin | E-Ink Pin | 功能 |
|-----------|-----------|------|
| GPIO 4 | CLK | SPI 时钟 (SCK) |
| GPIO 6 | DIN | SPI 数据 (MOSI) |
| GPIO 7 | CS | 片选 |
| GPIO 1 | DC | 数据/命令选择 |
| GPIO 2 | RST | 复位 |
| GPIO 10 | BUSY | 忙信号 |

## 3. 接线示意图

```
                    ┌───────────────────┐
                    │   ESP32-C3        │
                    │   SuperMini       │
USB-C ──> TP5000 ──>│ 3V3         GPIO4 ├──> CLK (E-Ink)
                    │             GPIO6 ├──> DIN (E-Ink)
          Battery ──>│ GND         GPIO7 ├──> CS  (E-Ink)
                    │             GPIO1 ├──> DC  (E-Ink)
  100K ──> GPIO0 <──│ ADC         GPIO2 ├──> RST (E-Ink)
                    │             GPIO10├──> BUSY(E-Ink)
                    └───────────────────┘

                    ┌──────────────────┐
                    │  4.2" E-Paper    │
                    │  400 x 300       │
                    │  1-bit B/W       │
                    └──────────────────┘
```

## 4. 电源设计

### 选择 LiFePO4 的原因

- 标称电压 3.2V，可直接驱动 ESP32 (工作电压 3.0-3.6V)，无需 LDO/DC-DC。
- 安全性好，不易鼓包燃烧。
- 循环寿命长 (2000+ 次)。

### 充电注意事项

- TP5000 模块默认截止电压为 4.2V (锂离子)，需要跳线切换到 3.6V (磷酸铁锂) 模式。
- 充电电流建议 500mA。

### 电压检测

- 通过 100K 电阻分压后接 GPIO 0 (ADC) 读取电池电压。
- ADC 校准需要实际测量后修正。

## 5. 续航估算

- ESP32-C3 Deep Sleep 电流: ~5uA (目标 < 20uA)
- E-Paper 保持显示功耗: 0 (电子墨水特性)
- 每次唤醒工作时间: ~15 秒
- WiFi 工作电流: ~130mA

按每天刷新 12 次计算:
- 活跃功耗: 12 x 15s x 130mA = 23,400 mAs/天 = 6.5mAh/天
- 睡眠功耗: 24h x 3600s x 0.02mA = 1.73mAh/天
- 日均消耗: ~8.2mAh
- 1500mAh 电池预计续航: **~180 天 (6 个月)**

## 6. 组装步骤

1. **焊接 TP5000 模块:** 将 TP5000 充电模块的输入端连接 USB-C 接口，输出端连接电池。
2. **连接电源:** 电池正极连接 ESP32 的 3V3 引脚，负极连接 GND。
3. **连接电压检测:** 从电池正极经 100K 电阻连接到 GPIO 0。
4. **连接 E-Ink 屏幕:** 按上方引脚映射表，使用杜邦线连接 6 根 SPI 信号线。
5. **固定结构:** 使用 M3 铜柱和 PCB 夹板固定，或 3D 打印外壳。
6. **烧录固件:** 参考 [快速开始](../README.md#-快速开始) 中的固件烧录部分。

## 7. 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| 屏幕不显示 | SPI 接线错误 | 检查 6 根信号线是否正确连接 |
| 屏幕闪烁后无内容 | 数据传输错误 | 检查 CS、DC 引脚 |
| 无法连接 WiFi | 信号弱 / 密码错误 | 重新配网，靠近路由器 |
| 电池不充电 | TP5000 未切换到 LiFePO4 模式 | 检查跳线帽位置 |
| 续航短 | Deep Sleep 未正常进入 | 检查固件日志，确认 LED 已关闭 |
